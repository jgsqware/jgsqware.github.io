<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>2015s on JG sQware</title>
    <link>http://juliengarcia.github.io/2015/</link>
    <description>Recent content in 2015s on JG sQware</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <lastBuildDate>Fri, 20 Nov 2015 11:52:33 +0100</lastBuildDate>
    <atom:link href="http://juliengarcia.github.io/2015/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>SonarQube with PostgreSQL on Docker</title>
      <link>http://juliengarcia.github.io/2015/11/draft/sonarqube-with-postgresql-on-docker/</link>
      <pubDate>Fri, 20 Nov 2015 11:52:33 +0100</pubDate>
      
      <guid>http://juliengarcia.github.io/2015/11/draft/sonarqube-with-postgresql-on-docker/</guid>
      <description>

&lt;h1 id=&#34;run-sonarqube-on-postgresql:109f71eb4cb170550111d782491e538d&#34;&gt;Run SonarQube on PostgreSQL&lt;/h1&gt;

&lt;p&gt;Use this &lt;code&gt;docker-compose.yml&lt;/code&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-yaml&#34;&gt;sonarqube:
  image: sonarqube
  ports:
   - &amp;quot;9000:9000&amp;quot;
   - &amp;quot;5432:5432&amp;quot;
  links:
    - db:db
  environment:
   - SONARQUBE_JDBC_URL=jdbc:postgresql://db:5432/sonar

db:
  image: postgres
  environment:
   - POSTGRES_USER=sonar
   - POSTGRES_PASSWORD=sonar
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;then&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;&amp;gt; docker-compose up -d
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Then your SonarQube instance is available on &lt;code&gt;&amp;lt;DOCKER-MACHINE-IP&amp;gt;:9000&lt;/code&gt;.&lt;/p&gt;

&lt;h1 id=&#34;analyse-your-project:109f71eb4cb170550111d782491e538d&#34;&gt;Analyse your project&lt;/h1&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;&amp;gt; mvn sonar:sonar \
  -Dsonar.host.url=http://&amp;lt;DOCKER-MACHINE-IP&amp;gt;:9000 \
  -Dsonar.jdbc.url=jdbc:postgresql://&amp;lt;DOCKER-MACHINE-IP&amp;gt;/sonar
&lt;/code&gt;&lt;/pre&gt;

&lt;h1 id=&#34;backup-sonar-data:109f71eb4cb170550111d782491e538d&#34;&gt;Backup Sonar data&lt;/h1&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;&amp;gt; docker run --rm --link sonar_db_1:db -v $(pwd):/data -e PGPASSWORD=&amp;quot;sonar&amp;quot; postgres-backup -h db -U sonar -f /data/sonar_db_backup.sql
&lt;/code&gt;&lt;/pre&gt;

&lt;h1 id=&#34;restore-sonar-data:109f71eb4cb170550111d782491e538d&#34;&gt;Restore Sonar data&lt;/h1&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;&amp;gt; docker run --rm --link sonar_db_1:db -v $(pwd):/data -e PGPASSWORD=&amp;quot;sonar&amp;quot; postgres-restore -h db -U sonar -f /data/sonar_db_backup.sql
&lt;/code&gt;&lt;/pre&gt;
</description>
    </item>
    
    <item>
      <title>Registry - Docker Hub, at Home, for Free!</title>
      <link>http://juliengarcia.github.io/2015/11/docker-registry-installation/</link>
      <pubDate>Tue, 10 Nov 2015 11:00:00 +0100</pubDate>
      
      <guid>http://juliengarcia.github.io/2015/11/docker-registry-installation/</guid>
      <description>

&lt;blockquote&gt;
&lt;p&gt;Or how to have our docker registry hub locally&lt;/p&gt;

&lt;h2 id=&#34;due-to-the-slow-network-we-need-to-find-a-way-to-download-docker-images-from-local-network-instead-of-docker-hub:c34b9d8e1a9d73777d6418bc254d4972&#34;&gt;Due to the slow network, we need to find a way to download docker images from local network instead of Docker Hub.&lt;/h2&gt;

&lt;p&gt;When I start writing this article the &lt;a href=&#34;URL-TO-DOCKER-TRUSTED-REGISTRY&#34;&gt;Docker Trusted Registry&lt;/a&gt; was not released yet.
However, you can run it for free locally.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;This post is related to OSX docker-machine version. It&amp;rsquo;s almost the same on linux box.&lt;/p&gt;

&lt;h2 id=&#34;let-s-run-that-s-folk-s:c34b9d8e1a9d73777d6418bc254d4972&#34;&gt;Let&amp;rsquo;s Run that&amp;rsquo;s folk&amp;rsquo;s!&lt;/h2&gt;

&lt;p&gt;Docker offers his registry as a docker image. Nice guy!&lt;/p&gt;

&lt;p&gt;To start a registry, latest version, simply run&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;&amp;gt; docker run -p 5000:5000 --name registry registry:2
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;It will run, but will &lt;strong&gt;not persist&lt;/strong&gt; data when the container will stopped.
So we will use &lt;a href=&#34;Docker-Compose link&#34;&gt;docker-compose&lt;/a&gt;, Docker-compose help you to manage run of multiple container.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-yaml&#34;&gt;# data volume container
# The container is used to store data, backup and restore
storage:
  image: alpine
  volumes:
    - /var/lib/registry
  command: &amp;quot;true&amp;quot;

# Caching Container
# Should be use to cache registry and enhance velocity of registry

cache:
  image: redis

# Registry container
# This container handle the registry itself.
# Is running and expose 5000 port
# It use sqlalchemy as search engine. It&#39;s needed by frontend

backend:
  image: registry:2
  ports:
    - 5000:5000
  links:
    - cache
    - storage
  volumes_from:
    - storage
  environment:
    SETTINGS_FLAVOR: local
    STORAGE_PATH: /var/lib/registry
    SEARCH_BACKEND: sqlalchemy
    CACHE_REDIS_HOST: cache
    CACHE_REDIS_PORT: 6379
    CACHE_LRU_REDIS_HOST: cache
    CACHE_LRU_REDIS_PORT: 6379

# Frontend container
# Deploy a Frontend for registry.
# You can browse, delete,... your repository

frontend:
  image: konradkleine/docker-registry-frontend:v2
  ports:
    - 5080:80
  links:
    - backend
  environment:
    ENV_DOCKER_REGISTRY_HOST: backend
    ENV_DOCKER_REGISTRY_PORT: 5000

&lt;/code&gt;&lt;/pre&gt;

&lt;blockquote&gt;
&lt;p&gt;Caching through Redis is in place but not enabled actually
I need to add the restart-always in docker-compose&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Now run your docker-compose file to start your container.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;# Run docker-compose up -d to start all container
# -d is for running container as daemon

&amp;gt; docker-compose up -d
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Your own docker registry is now available:
- you can &lt;strong&gt;pull*, **push&lt;/strong&gt;, &lt;strong&gt;search&lt;/strong&gt; repository on &lt;IP-OF-DOCKER&gt;:5000
- you can browse the repository on &lt;IP-OF-DOCKER&gt;:5080&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;http://juliengarcia.github.io/images/2015/11/docker-registry-frontend.png&#34; alt=&#34;Docker Registry Frontend&#34; /&gt;
&lt;/p&gt;

&lt;h2 id=&#34;everywhere-you-want-it-everywhere:c34b9d8e1a9d73777d6418bc254d4972&#34;&gt;Everywhere&amp;hellip; You want it everywhere&lt;/h2&gt;

&lt;p&gt;You need to open the vm port 5080 and 5000 to put your registry on the network.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;# use VBoxManage controlvm &amp;lt;VM-NAME&amp;gt; natpf1 &amp;lt;RULE-NAME&amp;gt;,tcp,&amp;lt;INTERFACE IP&amp;gt;,&amp;lt;VM-PORT-TO-OPEN&amp;gt;,,&amp;lt;DOCKER-PORT-TO-MAP&amp;gt;
# Here, we are creating a rule registry in vm registry, mapping the docker port 5000 to the vm port 5000 on every interface

&amp;gt; VBoxManage controlvm registry natpf1 registry,tcp,0.0.0.0,5000,,5000
&amp;gt; VBoxManage controlvm registry natpf1 registry-ui,tcp,0.0.0.0,5080,,5080
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Now, you access over the network with:
- repository: on &lt;IP-OF-HOST&gt;:5000
- UI: on &lt;IP-OF-HOST&gt;:5080&lt;/p&gt;

&lt;h2 id=&#34;and-now-action:c34b9d8e1a9d73777d6418bc254d4972&#34;&gt;And now&amp;hellip; Action!&lt;/h2&gt;

&lt;h3 id=&#34;allow-connection-to-insecure-registry:c34b9d8e1a9d73777d6418bc254d4972&#34;&gt;Allow connection to insecure registry&lt;/h3&gt;

&lt;p&gt;As the registry is not secure by certificate actually (&lt;em&gt;it will be in another story&lt;/em&gt;),
we need to tell docker to allow communication with this insecure registry.&lt;/p&gt;

&lt;p&gt;It can be done by adding &lt;code&gt;--insecure-registry=&amp;lt;IP-OF-REGISTRY&amp;gt;:&amp;lt;PORT-OF-REGISTRY&amp;gt;&lt;/code&gt; in the boot2docker profile.&lt;/p&gt;

&lt;p&gt;So,&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;# SSH your docker-machine
# docker-machine ssh &amp;lt;DOCKER-MACHINE-NAME&amp;gt;
&amp;gt; docker-machine ssh registry

# Add docker-registry as resolved name in /etc/hosts
# It will be more user-friendly
&amp;gt; sudo vi /etc/hosts
&amp;lt;IP OF Registry&amp;gt; docker-registry
# quit vi with :wq to save file

# Open in vi the boot2docker profile.
# profile is the configuration file used by docker when it start in boot2docker
&amp;gt; sudo vi /var/lib/boot2docker/profile

# Add line &#39;--insecure-registry docker-registry:5000&#39; in **EXTRA_ARGS**
EXTRA_ARGS=&#39;
--label provider=virtualbox
--insecure-registry docker-registry:5000
&#39;
# quit vi with :wq to save file

# Restart docker
&amp;gt; sudo /etc/init.d/docker restart
# Quit docker machine by CTRL-D

&lt;/code&gt;&lt;/pre&gt;

&lt;h4 id=&#34;errors-what:c34b9d8e1a9d73777d6418bc254d4972&#34;&gt;Errors&amp;hellip; What?&lt;/h4&gt;

&lt;p&gt;If you try to access your insecure registry without define it as insecure-registry, you will received the following error when you will try to &lt;em&gt;push/pull&lt;/em&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;&amp;gt; docker pull 192.168.99.101:5000/registry
     unable to ping registry endpoint https://192.168.99.101:5000/v0/
       v2 ping attempt failed with error: Get https://192.168.99.101:5000/v2/: tls: oversized record received with length 20527
         v1 ping attempt failed with error: Get https://192.168.99.101:5000/v1/_ping: tls: oversized record received with length 20527
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Sometimes, docker run out of his mind when restarting
You can see it in log, with last line as&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;# In your docker machine. Remember, SSH things.
&amp;gt; tail -f /var/log/docker.log
level=fatal msg=&amp;quot;Shutting down due to ServeAPI error: listen tcp 0.0.0.0:2376: bind: address already in use&amp;quot;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;If you see that, just kill docker and start it again&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;&amp;gt; sudo killall -9 docker
&amp;gt; sudo /etc/init.d/docker start
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;New, it should be ok&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;&amp;gt; tail -f /var/log/docker.log
level=info msg=&amp;quot;Daemon has completed initialization&amp;quot;
level=info msg=&amp;quot;Docker daemon&amp;quot; commit=f4bf5c7 execdriver=native-0.2 graphdriver=aufs version=1.8.3
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;push-image:c34b9d8e1a9d73777d6418bc254d4972&#34;&gt;Push image&lt;/h3&gt;

&lt;p&gt;Now, to &lt;strong&gt;push&lt;/strong&gt; images to your own docker registry, you have to tag your image with the docker registry url in it&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;# docker tag &amp;lt;IMAGE-NAME:?tag&amp;gt; &amp;lt;REGISTRY-IP&amp;gt;:&amp;lt;PORT&amp;gt;/&amp;lt;IMAGE-NAME:?tag&amp;gt;
&amp;gt; docker tag registry docker-registry:5000/alpine

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Now you can push it&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;# docker push &amp;lt;TAG-WITH-REPO-URL&amp;gt;
&amp;gt; docker push docker-registry:5000/alpine
The push refers to a repository [docker-registry:5000/alpine] (len: 1)
f4fddc471ec2: Image successfully pushed
latest: digest: sha256:347850a844a7b7be3c92a770477827b4a1af922de2190e70b3a8e994051f244a size: 1369
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;pull-image:c34b9d8e1a9d73777d6418bc254d4972&#34;&gt;Pull image&lt;/h3&gt;

&lt;p&gt;To &lt;strong&gt;pull&lt;/strong&gt; images from your own docker registry, you have to pull with the docker registry url in it&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;# docker pull &amp;lt;REGISTRY-IP&amp;gt;:&amp;lt;PORT&amp;gt;/&amp;lt;IMAGE-NAME:?tag&amp;gt;
&amp;gt; docker pull docker-registry:5000/registry
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;backup-restore:c34b9d8e1a9d73777d6418bc254d4972&#34;&gt;Backup &amp;amp; Restore&lt;/h2&gt;

&lt;h3 id=&#34;backup-registry-data:c34b9d8e1a9d73777d6418bc254d4972&#34;&gt;Backup registry data&lt;/h3&gt;

&lt;p&gt;As we have create a &lt;a href=&#34;http://docs.docker.com/engine/userguide/dockervolumes/&#34;&gt;Data Volume Container&lt;/a&gt;, we can backup the folder where the registry save its data to a tar file easily.&lt;/p&gt;

&lt;p&gt;We will run a new container and mount volumes from registry data container, then mount the local folder to &lt;code&gt;/backup&lt;/code&gt; in the container. Then, we will compress the registry data to a tarball.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;&amp;gt; docker run --volumes-from registry_storage_1 -v $(pwd):/backup alpine sh -c &amp;quot;cd /var/lib/registry &amp;amp;&amp;amp; tar cvf /backup/registry-data.tar .&amp;quot;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;You have now a file &lt;code&gt;registry-data.tar&lt;/code&gt; in your local folder.&lt;/p&gt;

&lt;h3 id=&#34;restore-registry-data:c34b9d8e1a9d73777d6418bc254d4972&#34;&gt;Restore registry data&lt;/h3&gt;

&lt;p&gt;You can now restore the previously backuped registry data to a new registry data container.&lt;/p&gt;

&lt;p&gt;So after running the docker-compose, you will have a registry data container but it will be empty. Then, you will have to uncompress the &lt;code&gt;registry-data.tar&lt;/code&gt; in the corresponding directory in the registry data container.&lt;/p&gt;

&lt;p&gt;We will run a new container and mount volumes from registry data container, and mount the local folder to &lt;code&gt;/backup&lt;/code&gt;in the container. Then, we will decompress the registry data to the registry data folder.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;&amp;gt; docker run --volumes-from registry_storage_1 -v $(pwd):/backup alpine sh -c &amp;quot;cd /var/lib/registry &amp;amp;&amp;amp; tar xvf /backup/registry-data.tar&amp;quot;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;New, you will can check your repository UI url, your backuped images are restored.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Docker: Update your hosts with docker-machine ips automatically</title>
      <link>http://juliengarcia.github.io/2015/11/docker-hosts-automatic-update/</link>
      <pubDate>Tue, 10 Nov 2015 09:00:00 +0100</pubDate>
      
      <guid>http://juliengarcia.github.io/2015/11/docker-hosts-automatic-update/</guid>
      <description>&lt;p&gt;I develop a small script to update your &lt;code&gt;/etc/hosts&lt;/code&gt; with your docker machine ip and a related resolved name.&lt;/p&gt;

&lt;p&gt;You can found the gist here  &lt;a href=&#34;https://gist.github.com/juliengarcia/9a208ca5cf6590b25150&#34;&gt;update-hosts-docker-machine.sh&lt;/a&gt; or here is it:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;#!/usr/bin/env bash
#Usage docker-machine-update-hosts.sh hosts.conf
#arg1 is a configuration file with hosts

#Remove existing lines from hosts
while read -r line; do
    [[ &amp;quot;$line&amp;quot; =~ ^#.*$ ]] &amp;amp;&amp;amp; continue
  echo &amp;quot;Configuration: $line&amp;quot;
  IFS=&#39;=&#39; read -a configuration &amp;lt;&amp;lt;&amp;lt; &amp;quot;$line&amp;quot;
  machine=${configuration[0]}

  IFS=&#39;,&#39; read -a hosts &amp;lt;&amp;lt;&amp;lt; &amp;quot;${configuration[1]}&amp;quot;

  DOCKER_IP=$(docker-machine ip $machine)
  for host in &amp;quot;${hosts[@]}&amp;quot;; do
    echo &amp;quot;Adding $DOCKER_IP  $host&amp;quot;
    sudo bash -c &amp;quot;sed -i &#39;&#39; &#39;/^192\.168\.99\.[[:digit:]]\{0,3\}[[:space:]]*$host/d&#39; /etc/hosts&amp;quot;
    sudo bash -c &amp;quot;echo &#39;$DOCKER_IP  $host&#39; &amp;gt;&amp;gt; /etc/hosts&amp;quot;
  done

done &amp;lt; &amp;quot;$1&amp;quot;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;You have to use it with a configuration file, &lt;code&gt;hosts.conf&lt;/code&gt;.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;# Pattern
# &amp;lt;docker-machine name&amp;gt;=&amp;lt;host name&amp;gt;,&amp;lt;host name&amp;gt;,...
registry=docker-registry
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Then, run it with&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;&amp;gt; update-hosts-docker-machine.sh hosts.conf
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;On OSX, you need to flush the dns cache&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;&amp;gt; dscacheutil -flushcache
&lt;/code&gt;&lt;/pre&gt;
</description>
    </item>
    
    <item>
      <title>Docker: Installation on OSX</title>
      <link>http://juliengarcia.github.io/2015/11/docker-install-osx/</link>
      <pubDate>Tue, 10 Nov 2015 08:00:00 +0100</pubDate>
      
      <guid>http://juliengarcia.github.io/2015/11/docker-install-osx/</guid>
      <description>&lt;blockquote&gt;
&lt;p&gt;Let&amp;rsquo;s put some Docker in your OSX&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;The easier way to install Docker is with the &lt;a href=&#34;https://www.docker.com/docker-toolbox&#34;&gt;Docker Toolbox&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Docker toolbox install:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Docker Client&lt;/li&gt;
&lt;li&gt;Docker Machine&lt;/li&gt;
&lt;li&gt;Docker Compose&lt;/li&gt;
&lt;li&gt;Docker Kitematic&lt;/li&gt;
&lt;li&gt;VirtualBox&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;You can install Docker Toolbox via &lt;a href=&#34;http://brew.sh/&#34;&gt;Homebrew&lt;/a&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;&amp;gt; brew install docker-toolbox
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;You can run a Docker terminal with the VM boot2docker started and environment variable configured by running &lt;strong&gt;Docker Quickstart Terminal&lt;/strong&gt; app.&lt;/p&gt;

&lt;p&gt;Or you can run it by yourself with &lt;strong&gt;Docker Machine&lt;/strong&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;# List Docker Machine available

&amp;gt; docker-machine ls
NAME            ACTIVE   DRIVER       STATE     URL                         SWARM
default                  virtualbox   Running   tcp://192.168.99.101:2376

# To start a docker machine akka VM
# &amp;gt; docker-machine start &amp;lt;DOCKER-MACHINE-NAME&amp;gt;
&amp;gt; docker-machine start default

# To create a new docker machine
# docker-machine create --driver=&amp;lt;VM-DRIVER&amp;gt; &amp;lt;NAME-OF-VM&amp;gt;
# --driver=virtualbox is use in OSX to run with boot2docker
&amp;gt; docker-machine create --driver=virtualbox registry
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;To allow your docker-client to speak with your docker daemon inside your docker machine&amp;hellip;  &lt;em&gt;Huf&amp;hellip; you follow me, right?&lt;/em&gt;.
So, you need to configure some &lt;strong&gt;environment variables&lt;/strong&gt; like &lt;code&gt;DOCKER_HOST=&amp;lt;IP-OF-VM&amp;gt;&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;docker-machine help you on that with:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;&amp;gt; eval $(docker-machine env virtual-slave)

# If you want to run connect to your vm with a specific shell you can use (like the awesome oh-my-zsh) --shell=&amp;lt;SHELL-NAME&amp;gt;

&amp;gt; eval $(docker-machine env virtual-slave --shell=zsh)
&lt;/code&gt;&lt;/pre&gt;
</description>
    </item>
    
    <item>
      <title>Deploy Hugo on Github user pages</title>
      <link>http://juliengarcia.github.io/2015/11/deploy-hugo-on-github-user-pages/</link>
      <pubDate>Mon, 09 Nov 2015 08:00:00 +0100</pubDate>
      
      <guid>http://juliengarcia.github.io/2015/11/deploy-hugo-on-github-user-pages/</guid>
      <description>

&lt;p&gt;This blog is deployed on &lt;a href=&#34;https://help.github.com/articles/user-organization-and-project-pages/#user--organization-pages&#34;&gt;GitHub User Pages&lt;/a&gt; with &lt;a href=&#34;http://wercker.com/&#34;&gt;Wercker&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;First, I&amp;rsquo;ve follow the &lt;a href=&#34;https://gohugo.io/tutorials/automated-deployments/&#34;&gt;Hugo User Guide to deploy with Wercker&lt;/a&gt;. But it deploy on Github project pages and not Github User pages. You can use the Hugo user guide first than replace your &lt;code&gt;wercker.yml&lt;/code&gt; file with the following one.&lt;/p&gt;

&lt;p&gt;I&amp;rsquo;m planning to use Hugo as my personal blog generator. So, i&amp;rsquo;ve created a repository in Github &lt;a href=&#34;https://github.com/juliengarcia/rocket-vision&#34;&gt;Rocket-Vision&lt;/a&gt; that hold my &lt;strong&gt;not build&lt;/strong&gt; blog.&lt;/p&gt;

&lt;p&gt;Then I use Wercker to build and deploy on the &lt;a href=&#34;https://github.com/juliengarcia/juliengarcia.github.io&#34;&gt;Github User Page repository&lt;/a&gt;.&lt;/p&gt;

&lt;h2 id=&#34;configure-wercker-file:a63ae4cd6112f070c57749a3089cca2d&#34;&gt;Configure Wercker file&lt;/h2&gt;

&lt;p&gt;To build and deploy on Wercker, you need a &lt;code&gt;wercker.yml&lt;/code&gt; configuration file.&lt;/p&gt;

&lt;h3 id=&#34;build-steps:a63ae4cd6112f070c57749a3089cca2d&#34;&gt;Build steps&lt;/h3&gt;

&lt;p&gt;I use the &lt;code&gt;arjen/hugo-build@1.6.1&lt;/code&gt; step to build Hugo.&lt;/p&gt;

&lt;p&gt;I&amp;rsquo;ve defined the theme: &lt;em&gt;herring-cove&lt;/em&gt; and decide to not publish the drafts&lt;/p&gt;

&lt;h3 id=&#34;deploy-steps:a63ae4cd6112f070c57749a3089cca2d&#34;&gt;Deploy steps&lt;/h3&gt;

&lt;p&gt;First, I need to install &lt;strong&gt;Git&lt;/strong&gt; to be able to push in the right repository. It&amp;rsquo;s done by the &lt;code&gt;install-packages&lt;/code&gt; step.&lt;/p&gt;

&lt;p&gt;Then, I need to push into the &lt;a href=&#34;https://github.com/juliengarcia/juliengarcia.github.io&#34;&gt;juliengarcia.github.io&lt;/a&gt; and not in the &lt;a href=&#34;https://github.com/juliengarcia/rocket-vision&#34;&gt;Rocket-Vision&lt;/a&gt;. So, I use the &lt;code&gt;leipert/git-push@0.7.6&lt;/code&gt; step.&lt;/p&gt;

&lt;p&gt;I configure the git token (&lt;code&gt;gh_oauth&lt;/code&gt; param) and destination repository (&lt;code&gt;repo: juliengarcia/juliengarcia.github.io&lt;/code&gt; param)&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-yaml&#34;&gt;box: debian
build:
  steps:
    - arjen/hugo-build@1.6.1:
      version: &amp;quot;0.14&amp;quot;
      theme: herring-cove
      flags: --buildDrafts=false

deploy:
  steps:
    - install-packages:
      packages: git
    - leipert/git-push@0.7.6:
      gh_oauth: $GIT_TOKEN
      repo: juliengarcia/juliengarcia.github.io
      basedir: public

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Now, on every push on Rocket-Vision repository, the hugo website is build then deploy on the juliengarcia.github.io repository and available on &lt;a href=&#34;http://juliengarcia.github.io&#34;&gt;http://juliengarcia.github.io&lt;/a&gt;&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>